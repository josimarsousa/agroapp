<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/navbar-modern.css">
    <link rel="stylesheet" href="/css/menu-override.css">
    <link rel="stylesheet" href="/css/agroapp-theme.css">
</head>
<body>
<%- include('../partials/header') %>

<div class="page-container fade-in">
    <div class="page-header">
        <div class="page-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M20 7L12 3L4 7M20 7L12 11M20 7V17L12 21M12 11L4 7M12 11V21M4 7V17L12 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
        <h1><%= title %></h1>
    </div>

    <div class="page-content">
        <% if (typeof error !== 'undefined' && error) { %>
            <div class="alert alert-danger">
                <%= error %>
            </div>
        <% } %>

        <div class="card slide-in">
            <div class="card-header">
                <h3 class="mb-0">
                    <% if (isEdit) { %>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
                            <path d="M11 4H4A2 2 0 0 0 2 6V20A2 2 0 0 0 4 22H18A2 2 0 0 0 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M18.5 2.5A2.121 2.121 0 0 1 21 4.621L19.379 6.242L17.758 4.621A2.121 2.121 0 0 1 18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M15 7L17 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Editar Produto
                    <% } else { %>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
                            <line x1="12" y1="5" x2="12" y2="19" stroke="currentColor" stroke-width="2"/>
                            <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        Novo Produto
                    <% } %>
                </h3>
            </div>

            <div class="card-body">
                <form id="productForm" action="/products/<%= isEdit ? 'edit/' + product.id : '' %>" method="POST">
                    <div class="form-group">
                        <label for="name" class="form-label">Nome do Produto:</label>
                        <input type="text" id="name" name="name" class="form-control" value="<%= product.name || '' %>" required>
                    </div>

                    <div class="form-group">
                        <label for="description" class="form-label">Descrição:</label>
                        <textarea id="description" name="description" class="form-control" rows="3"><%= product.description || '' %></textarea>
                    </div>

                    <div class="d-flex gap-3">
                        <div class="form-group" style="flex: 1;">
                            <label for="price" class="form-label">Preço:</label>
                            <input type="number" id="price" name="price" class="form-control" step="0.01" min="0" value="<%= product.price || '0.00' %>" required>
                        </div>

                        <div class="form-group" style="flex: 1;">
                            <label for="stock_quantity" class="form-label">Quantidade em Estoque:</label>
                            <input type="number" id="stock_quantity" name="stock_quantity" class="form-control" min="0" value="<%= product.stock_quantity || '0' %>" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="category_id" class="form-label">Categoria:</label>
                        <select id="category_id" name="category_id" class="form-control">
                            <option value="">Nenhuma Categoria</option>
                            <% categories.forEach(category => { %>
                                <option value="<%= category.id %>" <%= product.category_id == category.id ? 'selected' : '' %>>
                                    <%= category.name %>
                                </option>
                            <% }); %>
                        </select>
                    </div>
                </form>
            </div>

            <div class="card-footer">
                <div class="d-flex gap-3 justify-content-end">
                    <a href="/products" class="btn btn-secondary">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Cancelar
                    </a>
                    <button type="submit" form="productForm" class="btn btn-primary">
                        <% if (isEdit) { %>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 21H5A2 2 0 0 1 3 19V5A2 2 0 0 1 5 3H11L19 11V19A2 2 0 0 1 19 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <polyline points="17,21 17,13 7,13 7,21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <polyline points="7,3 7,8 15,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Atualizar Produto
                        <% } else { %>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <line x1="12" y1="5" x2="12" y2="19" stroke="currentColor" stroke-width="2"/>
                                <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            Criar Produto
                        <% } %>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="/js/script.js"></script>
</body>
</html>